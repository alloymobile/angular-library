<!-- demo-button-drop-down.html -->
<div class="container py-3 demo-dd-root">
  <h3 class="mb-3 text-center">TdButtonDropDown</h3>

  <!-- Usage snippet -->
  <div class="row mb-3">
    <div class="col-12 d-flex align-items-center justify-content-center">
      <pre class="bg-light text-dark border rounded-3 p-3 small mb-0 w-100 demo-snippet">
        <code>{{ tagSnippet }}</code>
      </pre>
    </div>
  </div>

  <!-- Tabs -->
  <div class="row mb-3">
    <div class="col-12 d-flex flex-wrap gap-2 justify-content-center">
      @for (t of TABS; track t.key) {
        <button
          type="button"
          class="btn btn-sm"
          [class.btn-primary]="activeTab === t.key"
          [class.btn-outline-primary]="activeTab !== t.key"
          (click)="setActiveTab(t.key)"
        >
          {{ t.label }}
        </button>
      }
    </div>
  </div>

  <!-- Live preview -->
  <div class="row mb-4">
    <div class="col-12 text-center">
      <td-button-drop-down [buttonDropDown]="model" (output)="handleOutput($event)"></td-button-drop-down>

      <div class="small text-secondary mt-2">
        Edit JSON to change dropdown button + menu. Click menu items to emit output.
      </div>
    </div>
  </div>

  <!-- JSON in / JSON out -->
  <div class="row g-3 align-items-stretch">
    <!-- Left: Input editor -->
    <div class="col-12 col-lg-6">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="fw-semibold">Input JSON (editable)</span>
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-sm btn-outline-secondary" (click)="resetJson()">
            Reset
          </button>

          <button type="button" class="btn btn-sm btn-outline-secondary" (click)="formatJson()" title="Format JSON">
            <i class="fa-solid fa-wand-magic-sparkles me-2" aria-hidden="true"></i>
            Format
          </button>
        </div>
      </div>

      <textarea
        class="form-control font-monospace"
        [class.is-invalid]="!!currentTab.parseError"
        rows="18"
        [ngModel]="currentTab.json"
        (ngModelChange)="onJsonChange($event)"
        spellcheck="false"
      ></textarea>

      @if (currentTab.parseError) {
        <div class="invalid-feedback d-block mt-1">{{ currentTab.parseError }}</div>
      }

      <div class="form-text">
        Button uses <code>TdButtonDropDownModel</code>. <code>icon</code> is optional. <code>linkBar.links</code>
        supports TdLink / TdLinkIcon / TdLinkLogo (hydrated by TdLinkBarModel).
      </div>
    </div>

    <!-- Right: Output inspector -->
    <div class="col-12 col-lg-6">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="fw-semibold">Output (from (output))</span>
        <button type="button" class="btn btn-sm btn-outline-danger" (click)="clearOutput()">
          Clear
        </button>
      </div>

      <textarea class="form-control font-monospace" rows="18" [ngModel]="currentTab.output" spellcheck="false"></textarea>

      <div class="form-text">
        Output shows the payload emitted by <code>TdButtonDropDown</code> (the clicked link item).
      </div>
    </div>
  </div>
</div>
