<div class="container py-4">
  <h3 class="text-center mb-3">TDButtonBar</h3>

  <!-- Tabs -->
  <ul class="nav nav-tabs justify-content-center mb-3">
    <li class="nav-item">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === 'AlloyButton'"
        (click)="setActiveTab('AlloyButton')"
      >
        TDButton
      </button>
    </li>
    <li class="nav-item">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === 'AlloyButtonIcon'"
        (click)="setActiveTab('AlloyButtonIcon')"
      >
        TDButtonIcon
      </button>
    </li>
    <li class="nav-item">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === 'AlloyButtonMixed'"
        (click)="setActiveTab('AlloyButtonMixed')"
      >
        TDButton + Dropdown
      </button>
    </li>
  </ul>

  <!-- Demo Card -->
  <div class="card p-3 mb-4">
    <h5 class="mb-3 text-center">{{ getTabLabel(activeTab) }}</h5>

    <!-- Row 1 — Usage snippet -->
    <div class="row mb-3">
      <div class="col-12 d-flex align-items-center justify-content-center">
        <pre class="bg-light text-dark border rounded-3 p-3 small mb-0">
          <code>{{ tagSnippet }}</code>
        </pre>
      </div>
    </div>

    <!-- Row 2 — Live demo -->
    <div class="row mb-4">
      <div class="col-12 text-center">
        <td-button-bar
          [buttonBar]="currentTab.model"
          (output)="handleOutput($event)"
        ></td-button-bar>
        <div class="small text-secondary mt-2">
          Click, hover, focus, keydown/keyup all emit via
          <code>output</code> as an <code>OutputObject</code>.
          Clicking a button marks it as "selected", and that button's cloned
          model gets <code>selected</code> (for example <code>"active"</code>) injected
          into its <code>active</code> field inside the output's
          <code>data.button</code>.
        </div>
      </div>
    </div>

    <!-- Row 3 — Editor + Output -->
    <div class="row g-3 align-items-stretch">
      <!-- Left: editable JSON -->
      <div class="col-12 col-lg-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="fw-semibold">Input JSON (editable)</span>
          <button
            type="button"
            class="btn btn-sm btn-outline-secondary"
            (click)="resetJson()"
          >
            Reset
          </button>
        </div>

        <textarea
          class="form-control font-monospace"
          [class.is-invalid]="currentTab.parseError"
          rows="18"
          [ngModel]="currentTab.json"
          (ngModelChange)="onJsonChange($event)"
          spellcheck="false"
        ></textarea>

        <div *ngIf="currentTab.parseError" class="invalid-feedback d-block mt-1">
          {{ currentTab.parseError }}
        </div>

        <div class="form-text">
          <ul class="mb-0 ps-3">
            <li>
              <code>type</code> decides which component is used for each
              button: <code>"AlloyButton"</code> or <code>"AlloyButtonIcon"</code>.
            </li>
            <li>
              <code>title</code> becomes a TagObject internally. If
              <code>title.name</code> is empty, the heading won't render.
            </li>
            <li>
              <code>buttons</code> is an array of plain objects here.
              The <code>ButtonBarObject</code> constructor automatically
              wraps each into a <code>ButtonObject</code> or <code>ButtonIconObject</code>.
            </li>
            <li>
              For dropdown support, add a button entry with
              <code>type: "dropdown"</code> and a <code>linkBar</code>.
            </li>
          </ul>
        </div>
      </div>

      <!-- Right: output inspector -->
      <div class="col-12 col-lg-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="fw-semibold">
            Output (from <code>output</code> callback)
          </span>
          <button
            type="button"
            class="btn btn-sm btn-outline-danger"
            (click)="clearOutput()"
          >
            Clear
          </button>
        </div>

        <textarea
          class="form-control font-monospace"
          rows="18"
          [ngModel]="currentTab.output"
          spellcheck="false"
          readonly
        ></textarea>

        <div class="form-text">
          This is the normalized <code>OutputObject</code>, typically:
          <ul class="mb-0 ps-3">
            <li>
              <code>type</code>: <code>"button"</code> or <code>"dropdown"</code>
            </li>
            <li>
              <code>action</code>: e.g. <code>"click"</code>, <code>"keydown"</code>, etc.
            </li>
            <li>
              <code>data</code>: includes button model snapshot
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
