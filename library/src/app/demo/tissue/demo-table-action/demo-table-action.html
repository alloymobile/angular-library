<div class="container py-3">
  <h3 class="mb-3 text-center">TDTableAction</h3>

  <!-- Tabs -->
  <ul class="nav nav-tabs justify-content-center mb-3">
    <li class="nav-item">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === 'withLink'"
        (click)="setActiveTab('withLink')"
      >
        With Row Link
      </button>
    </li>
    <li class="nav-item">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === 'noLink'"
        (click)="setActiveTab('noLink')"
      >
        Without Link
      </button>
    </li>
  </ul>

  <!-- Demo Card -->
  <div class="card p-3 mb-4">
    <h5 class="mb-3 text-center">{{ getTabLabel(activeTab) }}</h5>

    <!-- Row 1 — Usage snippet -->
    <div class="row mb-3">
      <div class="col-12 d-flex align-items-center justify-content-center">
        <pre class="bg-light text-dark border rounded-3 p-3 small mb-0">
          <code>{{ tagSnippet }}</code>
        </pre>
      </div>
    </div>

    <!-- Row 2 — Live table -->
    <div class="row mb-4">
      <div class="col-12">
        <td-table-action
          [tableAction]="currentTab.model"
          (output)="handleOutput($event)"
        ></td-table-action>
        <div class="small text-secondary mt-2">
          <strong>Row Link:</strong> When <code>link</code> is set (e.g., <code>"/vendors/&#123;id&#125;"</code>),
          clicking a cell emits <code>type: "row"</code> with <code>data.to</code> (resolved URL) plus row data.
          <br />
          <strong>Actions:</strong> Last column renders action buttons. Clicking emits <code>type: "table"</code>
          with the full row data.
          <br />
          <strong>Sort:</strong> Header click emits <code>type: "column"</code> with sort direction.
        </div>
      </div>
    </div>

    <!-- Row 3 — Input JSON (editable) and Output panel -->
    <div class="row g-3 align-items-stretch">
      <!-- Left: Input JSON -->
      <div class="col-12 col-lg-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="fw-semibold">Input JSON (editable)</span>
          <button
            type="button"
            class="btn btn-sm btn-outline-secondary"
            (click)="resetJson()"
          >
            Reset
          </button>
        </div>

        <textarea
          class="form-control font-monospace"
          [class.is-invalid]="currentTab.parseError"
          rows="20"
          [ngModel]="currentTab.json"
          (ngModelChange)="onJsonChange($event)"
          spellcheck="false"
        ></textarea>

        <div *ngIf="currentTab.parseError" class="invalid-feedback d-block mt-1">
          {{ currentTab.parseError }}
        </div>

        <div class="form-text">
          <ul class="mb-0 ps-3">
            <li>
              <code>link</code>: Template string like <code>"/path/&#123;id&#125;"</code>
              or <code>"/path/&#123;slug&#125;"</code>. Placeholders replaced with row values.
            </li>
            <li>
              <code>actions</code>: A ButtonBarObject config. Renders in last column.
            </li>
            <li>
              <code>rows</code>: Array of objects. Columns derived from first row keys (excluding <code>id</code>).
            </li>
          </ul>
        </div>
      </div>

      <!-- Right: Output JSON -->
      <div class="col-12 col-lg-6">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="fw-semibold">
            Output (from <code>output</code> callback)
          </span>
          <button
            type="button"
            class="btn btn-sm btn-outline-danger"
            (click)="clearOutput()"
          >
            Clear
          </button>
        </div>

        <textarea
          class="form-control font-monospace"
          rows="20"
          [ngModel]="currentTab.output"
          spellcheck="false"
          readonly
        ></textarea>

        <div class="form-text">
          Output types:
          <ul class="mb-0 ps-3">
            <li><code>type: "column"</code> — Header sort click</li>
            <li><code>type: "row"</code> — Row cell click (if <code>link</code> set)</li>
            <li><code>type: "table"</code> — Action button click</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
