<div class="container py-3">
  <h3 class="mb-3 text-center">TDModal</h3>

  <!-- Tabs -->
  <ul class="nav nav-tabs flex-wrap justify-content-center mb-3">
    <li class="nav-item" *ngFor="let tab of TABS">
      <button
        type="button"
        class="nav-link"
        [class.active]="activeTab === tab.key"
        (click)="setActiveTab(tab.key)"
      >
        {{ tab.label }}
      </button>
    </li>
  </ul>

  <!-- Tag snippet -->
  <div class="row mb-4">
    <div class="col-12 d-flex align-items-center justify-content-center">
      <pre class="bg-light text-dark border rounded-3 p-3 small mb-0 text-center w-100">
        <code>{{ tagSnippet }}</code>
      </pre>
    </div>
  </div>

  <!-- Open Modal Button -->
  <div class="row mb-4">
    <div class="col-12 text-center">
      <button
        type="button"
        class="btn btn-primary btn-lg"
        (click)="openModal()"
      >
        <i class="fa-solid fa-up-right-from-square me-2"></i>
        Open {{ currentTabConfig.label }}
      </button>
      <div class="small text-secondary mt-2">
        Click the button above to open the modal dialog.
        The modal auto-dismisses on successful submit.
      </div>
    </div>
  </div>

  <!-- The Modal Component (hidden until triggered) -->
  <td-modal
    [modal]="modalModel"
    (output)="handleOutput($event)"
  ></td-modal>

  <!-- Editable JSON + Output -->
  <div class="row g-3 align-items-stretch justify-content-center mb-5">
    <!-- Left: editable JSON -->
    <div class="col-12 col-lg-6">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="fw-semibold">
          Input JSON (editable) â€” {{ currentTabConfig.label }}
        </span>
        <button
          type="button"
          class="btn btn-sm btn-outline-secondary"
          (click)="resetJson()"
        >
          Reset
        </button>
      </div>

      <textarea
        class="form-control font-monospace"
        [class.is-invalid]="currentTab.parseError"
        rows="20"
        [ngModel]="currentTab.json"
        (ngModelChange)="onJsonChange($event)"
        spellcheck="false"
      ></textarea>

      <div *ngIf="currentTab.parseError" class="invalid-feedback d-block mt-1">
        {{ currentTab.parseError }}
      </div>

      <div class="form-text">
        <ul class="mb-0 ps-3">
          <li>
            <code>title</code> + <code>action</code> form the modal header
            (e.g., "Create a User").
          </li>
          <li>
            <code>fields</code> array defines the input fields.
          </li>
          <li>
            <code>data</code> can pre-populate field values.
          </li>
          <li>
            <code>submit</code> defines the submit button.
          </li>
        </ul>
      </div>
    </div>

    <!-- Right: output -->
    <div class="col-12 col-lg-6">
      <div class="fw-semibold mb-2 text-center text-lg-start">
        Output (from <code>output</code> callback)
      </div>
      <textarea
        class="form-control font-monospace bg-light border"
        rows="20"
        [ngModel]="currentTab.output"
        readonly
        spellcheck="false"
      ></textarea>

      <div class="form-text">
        On submit, <code>TDModal</code> emits:
        <ul class="mb-0 ps-3">
          <li><code>type</code>: <code>"modal"</code></li>
          <li><code>action</code>: <code>"submit"</code></li>
          <li><code>data</code>: field name-value pairs</li>
          <li><code>error</code>: true if validation failed</li>
        </ul>
      </div>
    </div>
  </div>
</div>
